<!DOCTYPE html>
<html>
<head>
    <title>Resumen de Cotización</title>
    <link rel="stylesheet" href="estilo_general.css">
</head>
<body>

<div class="site-content" style="width: 100%; padding: 0;">
    <div class="story-container"> <h1>Resumen de Cotización</h1>
        <p>¡Gracias por tu interés! Revisa que tu información sea correcta.</p>

        <h2>Datos del Cliente</h2>
        <table id="cliente-info" class="results-table">
            </table>

        <h2>Productos Seleccionados</h2>
        <table id="productos-info" class="results-table">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Cantidad</th>
                    <th>Precio Unitario</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody id="productos-body">
                </tbody>
            <tfoot>
                <tr>
                    <th colspan="3">TOTAL GENERAL</th>
                    <th id="total-general"></th>
                </tr>
            </tfoot>
        </table>

    </div>
</div>

<script>
    // 1. Definimos los precios de los productos (deben coincidir con el formulario)
    // --- ¡CAMBIO IMPORTANTE AQUÍ! ---
    const precios = {
        "Entrada General": 150000,
        "Entrada VIP": 300000,
        "Combo VIP + Bebidas": 450000
    };
    // --- FIN DEL CAMBIO ---

    // Función para formatear a pesos colombianos
    function formatPeso(value) {
        return new Intl.NumberFormat('es-CO', {
            style: 'currency',
            currency: 'COP',
            minimumFractionDigits: 0
        }).format(value);
    }

    // 2. Se ejecuta cuando la página carga
    window.onload = function() {
        const params = new URLSearchParams(window.location.search);

        // --- Info del Cliente (Sin cambios) ---
        const nombre = params.get('nombre') || 'N/A';
        const ciudad = params.get('ciudad') || 'N/A';
        const direccion = params.get('direccion') || 'N/A';
        const celular = params.get('celular') || 'N/A';

        const clienteHtml = `
            <tr><td><b>Nombres y Apellidos:</b></td><td>${nombre}</td></tr>
            <tr><td><b>Ciudad:</b></td><td>${ciudad}</td></tr>
            <tr><td><b>Dirección:</b></td><td>${direccion}</td></tr>
            <tr><td><b>Celular:</b></td><td>${celular}</td></tr>
        `;
        document.getElementById('cliente-info').innerHTML = clienteHtml;

        // --- Info de Productos (La lógica funciona igual, solo lee los nuevos valores) ---
        let productosBodyHtml = '';
        let totalGeneral = 0;

        // Revisamos producto 1
        if (params.has('prod1')) {
            const nombreProd = params.get('prod1'); // "Entrada General"
            const qty = parseInt(params.get('qty1') || 0);
            const precioUnit = precios[nombreProd]; // 150000
            const subtotal = qty * precioUnit;
            totalGeneral += subtotal;

            productosBodyHtml += `
                <tr>
                    <td>${nombreProd}</td>
                    <td>${qty}</td>
                    <td>${formatPeso(precioUnit)}</td>
                    <td>${formatPeso(subtotal)}</td>
                </tr>
            `;
        }

        // Revisamos producto 2
        if (params.has('prod2')) {
            const nombreProd = params.get('prod2'); // "Entrada VIP"
            const qty = parseInt(params.get('qty2') || 0);
            const precioUnit = precios[nombreProd]; // 300000
            const subtotal = qty * precioUnit;
            totalGeneral += subtotal;

            productosBodyHtml += `
                <tr>
                    <td>${nombreProd}</td>
                    <td>${qty}</td>
                    <td>${formatPeso(precioUnit)}</td>
                    <td>${formatPeso(subtotal)}</td>
                </tr>
            `;
        }

        // Revisamos producto 3
        if (params.has('prod3')) {
            const nombreProd = params.get('prod3'); // "Combo VIP + Bebidas"
            const qty = parseInt(params.get('qty3') || 0);
            const precioUnit = precios[nombreProd]; // 450000
            const subtotal = qty * precioUnit;
            totalGeneral += subtotal;

            productosBodyHtml += `
                <tr>
                    <td>${nombreProd}</td>
                    <td>${qty}</td>
                    <td>${formatPeso(precioUnit)}</td>
                    <td>${formatPeso(subtotal)}</td>
                </tr>
            `;
        }

        // Si no se seleccionó nada
        if (productosBodyHtml === '') {
            productosBodyHtml = '<tr><td colspan="4">No se seleccionaron productos.</td></tr>';
        }

        // 3. Insertamos el HTML en la página
        document.getElementById('productos-body').innerHTML = productosBodyHtml;
        document.getElementById('total-general').innerText = formatPeso(totalGeneral);
    };
</script>

</body>
</html>